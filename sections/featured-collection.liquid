{% schema %}
{
  "name": "Featured Collection",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Heading",
      "default": "Featured Collection"
    },
    {
      "type": "collection",
      "id": "collection",
      "label": "Collection"
    },
    {
      "type": "range",
      "id": "products_to_show",
      "min": 2,
      "max": 12,
      "step": 2,
      "default": 4,
      "label": "Products to show"
    }
  ],
  "presets": [
    {
      "name": "Featured Collection",
      "category": "Collection"
    }
  ]
}
{% endschema %}

<div class="section-{{ section.id }}-padding">
  {% if section.settings.title != blank %}
    <h2 class="featured-collection__heading">{{ section.settings.title | escape }}</h2>
  {% endif %}

  {%- assign collection = collections[section.settings.collection] -%}
  
  {% if collection != empty %}
    <div class="featured-collection__grid">
      {% for product in collection.products limit: section.settings.products_to_show %}
        <div class="featured-collection__item">
          <a href="{{ product.url }}" class="featured-collection__link">
            <img
              srcset="{%- if product.featured_image.width >= 165 -%}{{ product.featured_image | image_url: width: 165 }} 165w,{%- endif -%}
                {%- if product.featured_image.width >= 360 -%}{{ product.featured_image | image_url: width: 360 }} 360w,{%- endif -%}
                {%- if product.featured_image.width >= 535 -%}{{ product.featured_image | image_url: width: 535 }} 535w,{%- endif -%}"
              src="{{ product.featured_image | image_url: width: 360 }}"
              sizes="(min-width: 1100px) 535px, (min-width: 750px) calc((100vw - 130px) / 2), calc((100vw - 50px) / 2)"
              alt="{{ product.featured_image.alt | escape }}"
              loading="lazy"
              width="{{ product.featured_image.width }}"
              height="{{ product.featured_image.height }}"
              class="featured-collection__image"
            >
            <h3 class="featured-collection__title">{{ product.title }}</h3>
            <p class="featured-collection__price">{{ product.price | money }}</p>
          </a>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="featured-collection__empty">
      <p>{{ 'sections.featured_collection.empty' | t }}</p>
    </div>
  {% endif %}
</div>

{% stylesheet %}
.featured-collection__grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 20px;
  margin-top: 20px;
}

@media screen and (min-width: 750px) {
  .featured-collection__grid {
    grid-template-columns: repeat(4, 1fr);
  }
}

.featured-collection__heading {
  text-align: center;
  margin-bottom: 30px;
}

.featured-collection__item {
  text-align: center;
}

.featured-collection__image {
  width: 100%;
  height: auto;
  object-fit: cover;
}

.featured-collection__title {
  margin: 10px 0 5px;
  font-size: 1rem;
}

.featured-collection__price {
  margin: 0;
  color: rgba(var(--color-foreground), 0.75);
}
{% endstylesheet %} 